# Jane Street 训练任务仓库

## 项目简介
本仓库包含 Jane Street 训练任务的代码和结果，主要目标是训练一个多任务神经网络模型，用于预测目标变量（responder_6）和识别数据中的噪声。

## 数据预处理
- 数据来源：`train.parquet` 和 `features.csv`
- 特征处理：剔除缺失率超过15%的特征，对剩余特征进行中位数填充
- 噪声标注：使用滑动窗口（窗口大小为20）计算局部标准差，标记超过3倍全局标准差的样本为噪声
- 数据标准化：对特征进行Z-score标准化和分位数归一化（1%~99%）
- 数据重组：将数据按时间窗口（60个时间步）切割，并只保留能整除的部分

## 模型结构
- 多任务神经网络：同时预测目标变量和噪声
- 特征提取：使用多尺度CNN（3x3和7x7卷积分支）和SE注意力机制
- 输出分支：
  - 目标值预测分支：输出目标变量（responder_6）
  - 噪声预测分支：输出噪声概率

## 训练过程
- 训练集和测试集划分：按8:2的比例划分
- 训练参数：
  - 优化器：Adam
  - 损失函数：目标值使用MSE，噪声预测使用二元交叉熵
  - 训练轮数：20轮，使用早停机制（patience=3）
- 训练结果：
  - 目标值预测：MSE=0.7857, MAE=0.5747, R²=0.0046
  - 噪声预测：准确率等指标见可视化结果

## 可视化内容
- 训练损失曲线：目标值预测和噪声预测的损失变化
- 噪声预测效果：准确率和混淆矩阵
- 目标值预测指标：MAE和MSE的变化
- 预测结果可视化：真实值vs预测值、残差分布、局部时间序列对比等

## 文件说明
- `train_responder6.py`：训练脚本
- `visualize_training.py`：可视化脚本
- `prediction_results.csv`：预测结果
- 其他图片文件：训练过程、预测结果和指标的可视化

## 使用说明
1. 确保数据文件（`train.parquet`和`features.csv`）位于正确路径
2. 运行训练脚本：`python train_responder6.py` 本次试验使用slrum作业系统提交，提交脚本见run.sh
3. 查看可视化结果和预测指标

## 注意事项
- 训练数据仅使用部分样本（按窗口切割后能整除的部分）
- 模型对目标变量的解释能力较弱（R²接近0），后期可以进一步优化特征工程和模型结构 